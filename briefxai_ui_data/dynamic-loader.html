<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BriefXAI - Dynamic Data Loading</title>
    <link rel="stylesheet" href="static/dynamic-loader.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app" class="app-container">
        <!-- Connection Status Indicator -->
        <div class="connection-status" id="connection-status">
            <div class="status-indicator" id="status-indicator">
                <div class="status-dot"></div>
                <span class="status-text">Connecting...</span>
            </div>
            <div class="connection-metrics" id="connection-metrics">
                <span class="metric">Latency: <span id="latency">--ms</span></span>
                <span class="metric">Queue: <span id="queue-size">0</span></span>
            </div>
        </div>
        
        <!-- Main Interface -->
        <div class="main-interface">
            <div class="interface-header">
                <h1>üéØ BriefXAI Dynamic Analysis</h1>
                <div class="header-controls">
                    <button class="btn-secondary" onclick="toggleRealTimeMode()" id="realtime-toggle">
                        üì° Real-time: OFF
                    </button>
                    <button class="btn-secondary" onclick="showDataStream()">
                        üìä Data Stream
                    </button>
                </div>
            </div>
            
            <!-- Data Upload Section -->
            <div class="upload-section">
                <div class="upload-modes">
                    <button class="upload-mode active" data-mode="file" onclick="setUploadMode('file')">
                        üìÅ File Upload
                    </button>
                    <button class="upload-mode" data-mode="stream" onclick="setUploadMode('stream')">
                        üì° Stream Data
                    </button>
                    <button class="upload-mode" data-mode="api" onclick="setUploadMode('api')">
                        üîå API Integration
                    </button>
                </div>
                
                <!-- File Upload Mode -->
                <div class="upload-content" id="file-upload" data-mode="file">
                    <div class="upload-zone" id="upload-zone">
                        <div class="upload-prompt">
                            <div class="upload-icon">üì§</div>
                            <h3>Drop files or click to upload</h3>
                            <p>Support for JSON, CSV, streaming data</p>
                            <input type="file" id="file-input" multiple accept=".json,.csv">
                        </div>
                        <div class="upload-progress" id="upload-progress" style="display: none;">
                            <div class="progress-bar">
                                <div class="progress-fill" id="upload-progress-fill"></div>
                            </div>
                            <div class="progress-info">
                                <span id="upload-status">Uploading...</span>
                                <span id="upload-speed">0 MB/s</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Stream Mode -->
                <div class="upload-content" id="stream-upload" data-mode="stream" style="display: none;">
                    <div class="stream-config">
                        <h3>Configure Data Stream</h3>
                        <div class="config-row">
                            <label>Stream Type:</label>
                            <select id="stream-type" onchange="updateStreamConfig()">
                                <option value="websocket">WebSocket</option>
                                <option value="sse">Server-Sent Events</option>
                                <option value="polling">HTTP Polling</option>
                            </select>
                        </div>
                        <div class="config-row">
                            <label>Source URL:</label>
                            <input type="url" id="stream-url" placeholder="ws://localhost:8080/stream">
                        </div>
                        <div class="config-row">
                            <label>Batch Size:</label>
                            <input type="number" id="batch-size" value="100" min="1" max="1000">
                        </div>
                        <button class="btn-primary" onclick="startStream()">Start Stream</button>
                    </div>
                    
                    <div class="stream-monitor" id="stream-monitor" style="display: none;">
                        <div class="stream-stats">
                            <div class="stat-item">
                                <span class="stat-label">Messages/sec</span>
                                <span class="stat-value" id="messages-per-sec">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Total Received</span>
                                <span class="stat-value" id="total-received">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Buffer Size</span>
                                <span class="stat-value" id="buffer-size">0</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Processing Rate</span>
                                <span class="stat-value" id="processing-rate">0/sec</span>
                            </div>
                        </div>
                        <button class="btn-danger" onclick="stopStream()">Stop Stream</button>
                    </div>
                </div>
                
                <!-- API Integration Mode -->
                <div class="upload-content" id="api-upload" data-mode="api" style="display: none;">
                    <div class="api-config">
                        <h3>API Integration</h3>
                        <div class="integration-options">
                            <div class="integration-card" onclick="configureSlackIntegration()">
                                <div class="integration-icon">üí¨</div>
                                <h4>Slack</h4>
                                <p>Import channel messages</p>
                                <div class="integration-status">Setup Required</div>
                            </div>
                            <div class="integration-card" onclick="configureEmailIntegration()">
                                <div class="integration-icon">üìß</div>
                                <h4>Email</h4>
                                <p>Process email threads</p>
                                <div class="integration-status">Setup Required</div>
                            </div>
                            <div class="integration-card" onclick="configureCustomAPI()">
                                <div class="integration-icon">üîå</div>
                                <h4>Custom API</h4>
                                <p>Connect your data source</p>
                                <div class="integration-status">Configure</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Real-time Analysis Dashboard -->
            <div class="analysis-dashboard" id="analysis-dashboard" style="display: none;">
                <div class="dashboard-header">
                    <h2>Live Analysis Dashboard</h2>
                    <div class="analysis-controls">
                        <button class="btn-secondary" onclick="pauseAnalysis()" id="pause-btn">‚è∏Ô∏è Pause</button>
                        <button class="btn-secondary" onclick="clearAnalysis()">üóëÔ∏è Clear</button>
                        <button class="btn-primary" onclick="exportLiveResults()">üì• Export</button>
                    </div>
                </div>
                
                <div class="dashboard-grid">
                    <!-- Real-time Metrics -->
                    <div class="dashboard-card metrics-card">
                        <h3>Real-time Metrics</h3>
                        <div class="metrics-grid">
                            <div class="metric-item">
                                <div class="metric-value" id="live-conversations">0</div>
                                <div class="metric-label">Conversations</div>
                                <div class="metric-trend" id="conversations-trend">+0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" id="live-topics">0</div>
                                <div class="metric-label">Topics</div>
                                <div class="metric-trend" id="topics-trend">+0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" id="live-sentiment">0.0</div>
                                <div class="metric-label">Avg Sentiment</div>
                                <div class="metric-trend" id="sentiment-trend">+0.0</div>
                            </div>
                            <div class="metric-item">
                                <div class="metric-value" id="live-processing-rate">0</div>
                                <div class="metric-label">Processing Rate</div>
                                <div class="metric-trend" id="rate-trend">0/min</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Live Topic Stream -->
                    <div class="dashboard-card topics-card">
                        <h3>Emerging Topics</h3>
                        <div class="topics-stream" id="topics-stream">
                            <!-- Topics will be populated dynamically -->
                        </div>
                        <div class="topic-controls">
                            <button class="btn-sm" onclick="toggleTopicUpdates()">Auto-update</button>
                            <button class="btn-sm" onclick="freezeTopics()">Freeze View</button>
                        </div>
                    </div>
                    
                    <!-- Live Visualization -->
                    <div class="dashboard-card viz-card">
                        <h3>Live Visualization</h3>
                        <div class="viz-controls">
                            <select id="viz-type" onchange="changeVisualizationType()">
                                <option value="stream">Stream Flow</option>
                                <option value="bubbles">Topic Bubbles</option>
                                <option value="network">Connection Network</option>
                                <option value="heatmap">Sentiment Heatmap</option>
                            </select>
                            <button class="btn-sm" onclick="toggleVizAnimation()">Animation</button>
                        </div>
                        <div class="live-visualization" id="live-visualization">
                            <!-- D3.js visualization will be rendered here -->
                        </div>
                    </div>
                    
                    <!-- Processing Queue -->
                    <div class="dashboard-card queue-card">
                        <h3>Processing Queue</h3>
                        <div class="queue-visualization" id="queue-visualization">
                            <div class="queue-stage">
                                <div class="stage-label">Incoming</div>
                                <div class="stage-count" id="incoming-count">0</div>
                                <div class="stage-bar">
                                    <div class="stage-fill" id="incoming-fill"></div>
                                </div>
                            </div>
                            <div class="queue-stage">
                                <div class="stage-label">Processing</div>
                                <div class="stage-count" id="processing-count">0</div>
                                <div class="stage-bar">
                                    <div class="stage-fill" id="processing-fill"></div>
                                </div>
                            </div>
                            <div class="queue-stage">
                                <div class="stage-label">Completed</div>
                                <div class="stage-count" id="completed-count">0</div>
                                <div class="stage-bar">
                                    <div class="stage-fill" id="completed-fill"></div>
                                </div>
                            </div>
                        </div>
                        <div class="queue-controls">
                            <button class="btn-sm" onclick="adjustProcessingSpeed(0.5)">Slow</button>
                            <button class="btn-sm" onclick="adjustProcessingSpeed(1)">Normal</button>
                            <button class="btn-sm" onclick="adjustProcessingSpeed(2)">Fast</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Data Stream Panel -->
            <div class="stream-panel" id="stream-panel" style="display: none;">
                <div class="stream-header">
                    <h3>Data Stream Monitor</h3>
                    <button class="stream-close" onclick="hideDataStream()">√ó</button>
                </div>
                <div class="stream-content">
                    <div class="stream-log" id="stream-log">
                        <!-- Real-time log entries will appear here -->
                    </div>
                    <div class="stream-controls">
                        <button class="btn-sm" onclick="clearStreamLog()">Clear Log</button>
                        <button class="btn-sm" onclick="exportStreamLog()">Export Log</button>
                        <label>
                            <input type="checkbox" id="auto-scroll" checked> Auto-scroll
                        </label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Loading Overlays -->
        <div class="loading-overlay" id="loading-overlay" style="display: none;">
            <div class="loading-content">
                <div class="loading-spinner"></div>
                <h3 id="loading-title">Processing Data</h3>
                <p id="loading-message">Please wait while we analyze your conversations...</p>
                <div class="loading-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="loading-progress-fill"></div>
                    </div>
                    <div class="progress-details">
                        <span id="loading-step">Initializing...</span>
                        <span id="loading-percentage">0%</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Error Notifications -->
        <div class="notifications-container" id="notifications-container">
            <!-- Dynamic error/success notifications will appear here -->
        </div>
    </div>
    
    <script src="static/dynamic-loader.js"></script>
</body>
</html>